<div align="center">
  <h1>Sharkord</h1>
  <p><strong>A lightweight, self-hosted real-time communication platform</strong></p>
  
  [![Version](https://img.shields.io/github/v/release/Sharkord/sharkord)](https://github.com/Sharkord/sharkord/releases)
  [![License](https://img.shields.io/github/license/Sharkord/sharkord)](LICENSE)
  [![Downloads](https://img.shields.io/github/downloads/Sharkord/sharkord/total)](https://github.com/Sharkord/sharkord/releases)
  [![Last Commit](https://img.shields.io/github/last-commit/Sharkord/sharkord)](https://github.com/Sharkord/sharkord/commits)
  
  [![Bun](https://img.shields.io/badge/Bun-v1.3.5-green.svg)](https://bun.sh)
  [![Mediasoup](https://img.shields.io/badge/Mediasoup-v3.19.11-green.svg)](https://mediasoup.org)
</div>

[![ko-fi](https://ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/B0B71U3476)

## What is Sharkord?

> [!NOTE]
> Sharkord is in alpha stage. Bugs, incomplete features and breaking changes are to be expected.

Sharkord is a self-hosted communication platform that brings the most important Discord-like features to your own infrastructure. Host voice channels, text chat, and file sharing on your terms—no third-party dependencies, complete data ownership, and full control over your group's communication.

## Docs

For detailed documentation, please visit our [Documentation](https://sharkord.com/docs).

## Wanna Try It Out?

Check out the Live Demo at [demo.sharkord.com](https://demo.sharkord.com). The amount of ports opened for the demo is limited, so voice and video features will only work for a couple of users at a time. If you want to test it with a larger group, we recommend running your own instance.

## Getting Started

Sharkord is distributed as a standalone binary that bundles both server and client components. Get started by downloading the latest release for your platform from the [Releases](https://github.com/Sharkord/sharkord/releases) page. We ship binaries for Windows, macOS, and Linux.

#### Linux x64

```bash
curl -L https://github.com/sharkord/sharkord/releases/latest/download/sharkord-linux-x64 -o sharkord
chmod +x sharkord
./sharkord
```

#### Docker

Sharkord can also be run using Docker. Here's how to run it:

```bash
docker run \
  -p 4991:4991/tcp \
  -p 40000:40000/tcp \
  -p 40000:40000/udp \
  -v ./data:/root/.config/sharkord \
  --name sharkord \
  sharkord/sharkord:latest
```

#### Docker Compose

There is an example `docker-compose.yaml` in [docs/docker/docker-compose.yaml](docs/docker/docker-compose.yaml).

Common settings you might want to customize. These override config file values and are useful for Docker deployments:

| Variable                            | Default           | Description                           |
| ----------------------------------- | ----------------- | ------------------------------------- |
| `SHARKORD_PORT`                     | `4991`            | HTTP/WebSocket listen port            |
| `SHARKORD_DEBUG`                    | `false`           | Enable verbose logging                |
| `SHARKORD_WEBRTC_PORT`              | `40000`           | WebRTC server port (UDP+TCP)          |
| `SHARKORD_WEBRTC_ANNOUNCED_ADDRESS` | _(auto-detected)_ | Public IP announced to WebRTC clients |

#### Windows

1. Download the latest `sharkord-windows-x64.exe` from the [Releases](https://github.com/sharkord/sharkord/releases/latest) page.
2. Open Command Prompt and navigate to the directory where you downloaded the executable.
3. Run the server with the command: `.\sharkord-windows-x64.exe`

Make sure you download Microsoft Visual C++ 2015 - 2022 Redistributable (x64) from [here](https://aka.ms/vs/17/release/vc_redist.x64.exe) and install it before running Sharkord on Windows.

### Open The Client

Once the server is running, open your web browser and navigate to [http://localhost:4991](http://localhost:4991) to access the Sharkord client interface. If you're running the server on a different machine, replace `localhost` with the server's IP address or domain name.

> [!NOTE]
> Upon first launch, Sharkord will create a secure token and print it to the console. This token allows ANYONE to gain owner access to your server, so make sure to store it securely and do not lose it!

### Gain Owner Permissions

1. Login into your server
2. Open Dev Tools (`CTRL + Shift + I` or `Right Click > Inspect`)
3. Open the console
4. Type `useToken("your_token_here")` replacing `your_token_here` with the token generated by the server
5. Press enter
6. Your account will now have the owner role

The way of using this token will be more user friendly in the future.

## Configuration

Upon first run, Sharkord will generate a default configuration file located at `~/.config/sharkord/config.ini`. You can modify this file to customize your server settings.

### Options

| Field              | Default   | Description                                                                                                                   |
| ------------------ | --------- | ----------------------------------------------------------------------------------------------------------------------------- |
| `port`             | `4991`    | The port number on which the server will listen for HTTP and WebSocket connections                                            |
| `debug`            | `false`   | Enable debug logging for detailed server logs and diagnostics                                                                 |
| `autoupdate`       | `false`   | When enabled, it will automatically check for and install updates with no user intervention                                   |
| `webrtcPort`       | `40000`   | The port for the WebRTC server to listen on (UDP+TCP)                                                                         |
| `announcedAddress` | _(empty)_ | When set, announces this address for WebRTC connections. Useful when your reverse proxy is on a different host than Sharkord. |

## HTTPS Setup

At the moment, Sharkord does not have built-in support for HTTPS. To secure your server with HTTPS, we recommend using a reverse proxy like Nginx or Caddy in front of Sharkord. This setup allows you to manage SSL/TLS certificates and handle secure connections.

Reverse proxies should be set up with 3 forwarding rules.

1. HTTPS (Port 443 - Bonus points for binding HTTP to port 80 and auto-upgrading to HTTPS) sharkord.example.com forwarding to Sharkord's IP on port 4991.
2. Raw UDP port 40000 to Sharkord's webRtcServerPort default 40000.
3. Raw TCP port 40000 to Sharkord's webRtcServerPort default 40000.

Examples with http auto-upgrade - If using these examples, be sure to replace <sharkcord-machine-ip> with the actual IP of your sharkord instance:

```Caddyfile
# Caddyfile for sharkord.example.com
# HTTPS reverse proxy with automatic HTTP to HTTPS redirect and TCP/UDP forwarding

# HTTPS reverse proxy for sharkord.example.com
# Caddy automatically:
# - Obtains SSL certificates from Let's Encrypt
# - Redirects HTTP (port 80) to HTTPS (port 443)
# - Renews certificates automatically
sharkord.example.com {
    reverse_proxy <sharkord-machine-ip>:4991
}

# TCP/UDP forwarding on port 40000
# Note: This requires the Caddy layer4 plugin
# Install with: xcaddy build --with github.com/mholt/caddy-l4
{
    layer4 {
        :40000 {
            route {
                proxy {
                    upstream <sharkord-machine-ip>:40000
                }
            }
        }
    }
}
```

```nginx.conf
# Nginx configuration for sharkord.example.com
# Place this in /etc/nginx/nginx.conf or include it in your main config

# HTTP/HTTPS Configuration
http {
    # Basic settings
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;

    # Logging
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    # HTTP Server - Redirect all HTTP traffic to HTTPS
    server {
        listen 80;
        listen [::]:80;
        server_name sharkord.example.com;

        # Redirect all HTTP requests to HTTPS
        return 301 https://$host$request_uri;
    }

    # HTTPS Server - Main configuration
    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;
        server_name sharkord.example.com;

        # SSL Certificate paths (Let's Encrypt default paths)
        # These will be created automatically if using Certbot
        ssl_certificate /etc/letsencrypt/live/sharkord.example.com/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/sharkord.example.com/privkey.pem;

        # SSL Configuration - Modern and secure
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';
        ssl_prefer_server_ciphers off;

        # Enable OCSP stapling
        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_trusted_certificate /etc/letsencrypt/live/sharkord.example.com/chain.pem;

        # Security headers
        add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
        add_header X-Frame-Options "SAMEORIGIN" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header X-XSS-Protection "1; mode=block" always;

        location / {
            proxy_pass http://<sharkord-machine-ip>:4991;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            # WebSocket support (if needed)
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            # Timeouts
            proxy_connect_timeout 60s;
            proxy_send_timeout 60s;
            proxy_read_timeout 60s;
        }
    }
}

# TCP/UDP Stream Configuration
# This requires the nginx stream module (usually included by default)
stream {
    # Logging for stream
    log_format basic '$remote_addr [$time_local] '
                     '$protocol $status $bytes_sent $bytes_received '
                     '$session_time';

    access_log /var/log/nginx/stream-access.log basic;
    error_log /var/log/nginx/stream-error.log;

    # TCP forwarding on port 40000
    server {
        listen 40000;
        listen [::]:40000;
        proxy_pass <sharkord-machine-ip>:40000;
        proxy_timeout 10s;
        proxy_connect_timeout 5s;
    }

    # UDP forwarding on port 40000
    server {
        listen 40000 udp;
        listen [::]:40000 udp;
        proxy_pass <sharkord-machine-ip>:40000;
        proxy_timeout 10s;
        proxy_responses 1;
    }
}

```

## Plugins (experimental)

See the [Plugin SDK](packages/plugin-sdk/README.md) for more information on creating and using plugins with Sharkord.

> [!IMPORTANT]  
> If you are planning to use plugins, it's recommended to use Docker since they can execute arbitrary code on the host machine, which may pose security risks. Only use plugins you trust.

Example plugins:

- [Sharkord Music Bot](https://github.com/diogomartino/sharkord-music-bot) - A plugin that adds music playback capabilities to Sharkord voice channels using YouTube as a source.
- [Sharkord IPTV](https://github.com/diogomartino/sharkord-iptv) - A plugin that allows users to stream IPTV channels directly within Sharkord voice channels.

## Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Acknowledgments

Built with amazing open-source technologies:

- [Bun](https://bun.sh)
- [tRPC](https://trpc.io)
- [Mediasoup](https://mediasoup.org)
- [Drizzle ORM](https://orm.drizzle.team)
- [React](https://react.dev)
- [Radix UI](https://www.radix-ui.com)
- [ShadCN UI](https://ui.shadcn.com/)
- [Tailwind CSS](https://tailwindcss.com)

<div align="center">
  <p>Made with ❤️ by the Sharkord team</p>
  <p>
    <a href="https://github.com/Sharkord/sharkord">GitHub</a> •
    <a href="https://github.com/Sharkord/sharkord/issues">Issues</a> •
    <a href="https://github.com/Sharkord/sharkord/discussions">Discussions</a>
  </p>
</div>
